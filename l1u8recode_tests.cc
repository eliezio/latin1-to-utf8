#include <gtest/gtest.h>

#include "l1u8recode.h"

static const uint8_t rcsFileInput1[] = {
        0x31, 0x2e, 0x31, 0x0a, 0x6c, 0x6f, 0x67, 0x0a, 0x40, 0x42, 0x75, 0x67, 0x20, 0x66, 0x69, 0x78,  //1.1.log.@Bug fix
        0x65, 0x73, 0x0a, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x2d, 0x20, 0x6d, 0x6f, 0x64, 0x5f, 0x6d, 0x75,  //es..    - mod_mu
        0x6c, 0x74, 0x69, 0x73, 0x65, 0x72, 0x76, 0x2e, 0x63, 0x3a, 0x3a, 0x6d, 0x73, 0x5f, 0x74, 0x72,  //ltiserv.c::ms_tr
        0x61, 0x6e, 0x73, 0x61, 0x63, 0x74, 0x28, 0x29, 0x3a, 0x20, 0x65, 0x73, 0x74, 0x61, 0x76, 0x61,  //ansact(): estava
        0x20, 0x63, 0x6f, 0x6e, 0x73, 0x69, 0x64, 0x65, 0x72, 0x61, 0x6e, 0x64, 0x6f, 0x20, 0x74, 0x6f,  // considerando to
        0x64, 0x6f, 0x20, 0x73, 0x75, 0x63, 0x65, 0x73, 0x73, 0x6f, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x20,  //do sucesso.
        0x20, 0x72, 0x65, 0x74, 0x6f, 0x72, 0x6e, 0x61, 0x64, 0x6f, 0x20, 0x70, 0x65, 0x6c, 0x61, 0x20,  // retornado pela
        0x61, 0x70, 0x72, 0x5f, 0x73, 0x6f, 0x63, 0x6b, 0x65, 0x74, 0x5f, 0x72, 0x65, 0x63, 0x76, 0x28,  //apr_socket_recv(
        0x29, 0x20, 0x63, 0x6f, 0x6d, 0x6f, 0x20, 0x65, 0x72, 0x72, 0x6f, 0x3b, 0x0a, 0x0a, 0x43, 0x68,  //) como erro;..Ch
        0x61, 0x6e, 0x67, 0x65, 0x73, 0x0a, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x2d, 0x20, 0x4d, 0x61, 0x6b,  //anges..    - Mak
        0x65, 0x66, 0x69, 0x6c, 0x65, 0x3a, 0x20, 0x62, 0x75, 0x69, 0x6c, 0x64, 0x20, 0x64, 0x6f, 0x20,  //efile: build do
        0x73, 0x75, 0x62, 0x2d, 0x64, 0x69, 0x72, 0x65, 0x74, 0xf3, 0x72, 0x69, 0x6f, 0x20, 0x27, 0x77,  //sub-diret.rio 'w
        0x65, 0x62, 0x27, 0x3b, 0x0a, 0x0a, 0x20, 0x20, 0x20, 0x20, 0x2d, 0x20, 0x6d, 0x6f, 0x64, 0x5f,  //eb';..    - mod_
        0x6d, 0x75, 0x6c, 0x74, 0x69, 0x73, 0x65, 0x72, 0x76, 0x2e, 0x63, 0x3a, 0x0a, 0x09, 0x2d, 0x20,  //multiserv.c:..-
        0x63, 0xf3, 0x64, 0x69, 0x67, 0x6f, 0x20, 0x64, 0x61, 0x20, 0x68, 0x65, 0x78, 0x5f, 0x64, 0x75,  //c.digo da hex_du
        0x6d, 0x70, 0x28, 0x29, 0x20, 0x6d, 0x6f, 0x76, 0x69, 0x64, 0x6f, 0x20, 0x70, 0x61, 0x72, 0x61,  //mp() movido para
        0x20, 0x75, 0x6d, 0x20, 0x6e, 0x6f, 0x76, 0x6f, 0x20, 0x6d, 0xf3, 0x64, 0x75, 0x6c, 0x6f, 0x3b,  // um novo m.dulo;
        0x0a, 0x09, 0x2d, 0x20, 0x46, 0x69, 0x6c, 0x65, 0x46, 0x61, 0x63, 0x74, 0x6f, 0x72, 0x79, 0x20,  //..- FileFactory
        0x70, 0x61, 0x73, 0x73, 0x6f, 0x75, 0x20, 0x61, 0x20, 0x69, 0x6e, 0x66, 0x6f, 0x72, 0x6d, 0x61,  //passou a informa
        0x72, 0x20, 0x4c, 0x61, 0x73, 0x74, 0x2d, 0x4d, 0x6f, 0x64, 0x69, 0x66, 0x69, 0x65, 0x64, 0x20,  //r Last-Modified
        0x65, 0x20, 0x72, 0x65, 0x73, 0x70, 0x6f, 0x64, 0x65, 0x72, 0x20, 0x4e, 0x4f, 0x54, 0x5f, 0x4d,  //e respoder NOT_M
        0x4f, 0x44, 0x49, 0x46, 0x49, 0x45, 0x44, 0x0a, 0x09, 0x20, 0x20, 0x28, 0x76, 0x69, 0x61, 0x20,  //ODIFIED..  (via
        0x61, 0x70, 0x5f, 0x6d, 0x65, 0x65, 0x74, 0x73, 0x5f, 0x63, 0x6f, 0x6e, 0x64, 0x69, 0x74, 0x69,  //ap_meets_conditi
        0x6f, 0x6e, 0x73, 0x28, 0x29, 0x29, 0x3b, 0x0a, 0x09, 0x2d, 0x20, 0x73, 0x74, 0x79, 0x6c, 0x65,  //ons());..- style
        0x20, 0x73, 0x68, 0x65, 0x65, 0x74, 0x73, 0x20, 0x63, 0x6f, 0x6e, 0x64, 0x65, 0x6e, 0x73, 0x61,  // sheets condensa
        0x64, 0x61, 0x73, 0x20, 0x65, 0x6d, 0x20, 0x75, 0x6d, 0x20, 0xfa, 0x6e, 0x69, 0x63, 0x6f, 0x20,  //das em um .nico
        0x43, 0x53, 0x53, 0x20, 0x63, 0x68, 0x61, 0x6d, 0x61, 0x64, 0x6f, 0x20, 0x27, 0x63, 0x6f, 0x6e,  //CSS chamado 'con
        0x74, 0x65, 0x6e, 0x74, 0x2e, 0x63, 0x73, 0x73, 0x27, 0x3b, 0x0a, 0x09, 0x2d, 0x20, 0x48, 0x6f,  //tent.css';..- Ho
        0x72, 0x61, 0x20, 0x6e, 0x61, 0x20, 0x70, 0xe1, 0x67, 0x69, 0x6e, 0x61, 0x20, 0x70, 0x61, 0x73,  //ra na p.gina pas
        0x73, 0x6f, 0x75, 0x20, 0x61, 0x20, 0x73, 0x65, 0x72, 0x20, 0x6c, 0x6f, 0x63, 0x61, 0x6c, 0x3b,  //sou a ser local;
        0x0a, 0x40, 0x0a, 0x74, 0x65, 0x78, 0x74, 0x0a, 0x40, 0x47, 0x49, 0x46, 0x38, 0x39, 0x61, 0x79,  //.@.text.@GIF89ay
        0x00, 0x2e, 0x00, 0xd5, 0x00, 0x00, 0x00, 0x10, 0x94, 0x19, 0x31, 0x94, 0x00, 0x31, 0x9c, 0x00,  //..........1..1..
        0x31, 0x8c, 0x00, 0x29, 0x8c, 0x00, 0x29, 0xa5, 0x19, 0x4a, 0x8c, 0x19, 0x42, 0xa5, 0x19, 0x63,  //1..)..)..J..B..c
        0xad, 0x4a, 0x4a, 0x9c, 0x4a, 0x6b, 0xb5, 0x4a, 0x6b, 0xde, 0x52, 0x8c, 0x9c, 0x52, 0x8c, 0xde,  //.JJ.Jk.Jk.R..R..
        0x73, 0x6b, 0xce, 0x73, 0x8c, 0xc5, 0x73, 0xad, 0xde, 0x8c, 0xad, 0xbd, 0x9c, 0xad, 0xe6, 0x9c,  //sk.s..s.........
        0xd6, 0xef, 0xad, 0xad, 0xbd, 0xce, 0xad, 0xe6, 0xce, 0xd6, 0xe6, 0xce, 0xef, 0xef, 0xff, 0x52,  //...............R
        0x00, 0xff, 0x5a, 0x10, 0xef, 0x7b, 0x08, 0xff, 0x63, 0x00, 0xef, 0x63, 0x29, 0xef, 0x84, 0x31,  //..Z..{..c..c)..1
        0xef, 0x84, 0x5a, 0xf7, 0xad, 0x42, 0xf7, 0xa5                                                   //..Z..B..
};

static uint8_t  output[4096];

TEST (TestRCS, RCSFile1) {
    L1U8Recode l1U8Recode = L1U8Recode("\nlog\n", "\n@\n");
    size_t outputLen = l1U8Recode.translate(rcsFileInput1, sizeof(rcsFileInput1), output);
}
